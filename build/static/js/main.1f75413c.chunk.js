(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{49:function(e,t,n){e.exports=n(86)},85:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(17),c=n.n(l),s=n(12),i=n(16),o=n(46),u=n(47),m=n(18),b=n(5),p=n(1),f=n.n(p),d=n(3),g=n(14),E=n.n(g),v=null,h={getAll:function(){var e=Object(d.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=E.a.get("/api/blogs"),e.next=3,t;case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(d.a)(f.a.mark((function e(t){var n,a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:v}},a=E.a.post("/api/blogs",t,n),e.next=4,a;case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(d.a)(f.a.mark((function e(t,n){var a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=E.a.put("".concat("/api/blogs","/").concat(t),n),e.next=3,a;case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(d.a)(f.a.mark((function e(t){var n,a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:v}},a=E.a.delete("".concat("/api/blogs","/").concat(t),n),e.next=4,a;case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){v="bearer ".concat(e)}},y=function(){return function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},O=function(e,t,n){return Object(b.a)(Object(b.a)({},function(e,t){return e.find((function(e){return e.id===t}))}(e,t)),{},{likes:n})},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":case"DELETE_BLOG":return[].concat(Object(m.a)(e),[t.data]);case"LIKE_BLOG":return e.map((function(n){return n.id!==t.data.id?n:O(e,t.data.id,t.data.likes)}));default:return e}},j={getAll:function(){var e=Object(d.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=E.a.get("/api/users"),e.next=3,t;case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(d.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E.a.post("/api/users",t),e.next=3,n;case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(d.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E.a.delete("".concat("/api/users","/").concat(t)),e.next=3,n;case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w=function(){return function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getAll();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;case"NEW_USER":case"DELETE_USER":return[].concat(Object(m.a)(e),[t.data]);default:return e}},N=[],S=function(e,t,n){return N.forEach((function(e){return"number"===typeof e?clearTimeout(e):e})),function(){var a=Object(d.a)(f.a.mark((function a(r){return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("msg"!==t){a.next=8;break}return a.next=3,r(T(e,t));case 3:if(a.t0=a.sent,!a.t0){a.next=6;break}N.push(setTimeout((function(){r(T(null)),N=[]}),1e3*n));case 6:a.next=13;break;case 8:return a.next=10,r(B(e,t));case 10:if(a.t1=a.sent,!a.t1){a.next=13;break}N.push(setTimeout((function(){r(B(null)),N=[]}),1e3*n));case 13:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},T=function(e,t){return{type:"SET_MESSAGE",data:{text:e,which:t}}},B=function(e,t){return{type:"SET_ERRORMESSAGE",data:{text:e,which:t}}},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE":case"SET_ERRORMESSAGE":return t.data;default:return e}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ALL",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FILTER":return{type:t.type,content:t.content};default:return e}},R=Object(i.combineReducers)({blogs:k,users:x,message:L,filter:C}),_=Object(i.createStore)(R,Object(u.composeWithDevTools)(Object(i.applyMiddleware)(o.a)));h.getAll().then((function(e){return _.dispatch(y())})),j.getAll().then((function(e){return _.dispatch(w())}));var M=_,V=n(6),A=n(9),I=n(4),U={login:function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},F=function(e){var t=e.loginUser,n=Object(a.useState)(""),l=Object(A.a)(n,2),c=l[0],s=l[1],i=Object(a.useState)(""),o=Object(A.a)(i,2),u=o[0],m=o[1];return r.a.createElement("div",{className:"form-group-inline"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({username:c,password:u}),s(""),m("")}},r.a.createElement("div",{align:"left",className:"form-group-inline"},r.a.createElement("label",{id:"formlabel",htmlFor:"username"},"username:"),r.a.createElement("input",{id:"username",type:"text",className:"form-control",name:"Username",value:c,onChange:function(e){s(e.target.value)}}),r.a.createElement("label",{id:"formlabel",htmlFor:"password"},"password:"),r.a.createElement("input",{id:"password",type:"text",className:"form-control",name:"Password",value:u,onChange:function(e){m(e.target.value)}})),r.a.createElement("button",{className:"btn btn-primary",id:"login-button",type:"submit",style:{float:"left"}},"login")))},G=function(e){var t=Object(a.useState)(""),n=Object(A.a)(t,2),r=n[0],l=n[1];return{value:r,onChange:function(t){l(e?t.target.value:"")}}},D=function(e){var t=Object(V.c)(),n=Object(a.useState)(!0),l=Object(A.a)(n,2),c=l[0],s=l[1],i={display:e.visible?"":"none"},o=G(c),u=G(c),m=G(c);return r.a.createElement("div",{className:"col-auto",style:i},r.a.createElement("br",null),r.a.createElement("b",null,"Add a new blog"),r.a.createElement("form",null,r.a.createElement("div",{align:"left",className:"form-group"},r.a.createElement("label",{id:"formlabel"},"title:"),r.a.createElement("input",Object.assign({className:"form-control"},o))),r.a.createElement("div",{align:"left",className:"form-group"},r.a.createElement("label",{id:"formlabel"},"author:"),r.a.createElement("input",Object.assign({className:"form-control"},u))),r.a.createElement("div",{align:"left",className:"form-group"},r.a.createElement("label",{id:"formlabel"},"url:"),r.a.createElement("input",Object.assign({className:"form-control"},m))),r.a.createElement("div",{align:"left",className:"form-group"},r.a.createElement("button",{className:"btn btn-primary",id:"add-button",type:"submit",style:{float:"left",marginTop:"12px"},onClick:function(n){n.preventDefault(),s(!0);var a,r={title:o.value,author:u.value,url:m.value,user:e.user.name};try{t((a=r,function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.create(a);case 2:n=e.sent,t({type:"NEW_BLOG",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),t(S("added `".concat(o.value,"`"),"msg",5))}catch(l){t(S("error: `".concat(l,"`"),"err",5))}t(y()),e.setVisible(!e.visible),e.history.goBack()}},"add"),r.a.createElement("button",{className:"btn btn-primary",id:"reset-button",type:"submit",style:{float:"left",marginTop:"12px"},onClick:function(){s(!1)}},"reset")),r.a.createElement("div",{align:"right",className:"form-group"},r.a.createElement("button",{className:"btn btn-primary",id:"formback-button",type:"button",onClick:function(){e.history.goBack(),e.setVisible(!e.visible)},props:Object(b.a)({},e)},"back"))))},W=function(){var e=Object(V.c)();return r.a.createElement("div",{className:"col-auto"},r.a.createElement("form",{onChange:function(t){t.preventDefault();var n=t.target.value;e(function(e,t){return{type:"SET_FILTER",content:t}}(0,n))}},r.a.createElement("label",{htmlFor:"filter"},"filter shown with:"),r.a.createElement("input",{name:"filter",type:"text",className:"form-control"})))},z=function(e){var t=e.props,n=Object(I.g)().id,a={display:t.visible?"":"none"},l=t.users.find((function(e){return e.id===n}));return r.a.createElement("div",{style:a},r.a.createElement("br",null),r.a.createElement("b",{id:"b-left"},l.name),r.a.createElement("br",null),"added blogs",r.a.createElement("div",null,r.a.createElement("ul",null,t.blogs.map((function(e){return r.a.createElement("li",{className:"list-group-item",key:e.id},e.title)})))),r.a.createElement("br",null),r.a.createElement("button",{type:"button",id:"back-button",className:"btn btn-primary",onClick:function(){t.history.goBack(),t.setVisible(!t.visible)},props:Object(b.a)({},t)},"back"))},J={deleteUser:function(e){return function(){var t=Object(d.a)(f.a.mark((function t(n){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.remove(e);case 2:a=t.sent,n({type:"DELETE_USER",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},setMessage:S},H=Object(V.b)(null,J)((function(e){console.log("Users",e);var t={display:e.visible?"none":""};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:t},r.a.createElement("br",null),r.a.createElement("h2",null,"Users"),r.a.createElement("div",null,r.a.createElement("ul",null,r.a.createElement("table",{"striped-hover":!0},r.a.createElement("tbody",null,e.users.map((function(t){return r.a.createElement("tr",{key:t.id},r.a.createElement("th",null),r.a.createElement("td",null,r.a.createElement(s.b,{to:"/users/".concat(t.id),onClick:function(){e.setVisible(!0),e.history.push("/users")}},t.name)),r.a.createElement("th",null,"blogs created"),r.a.createElement("td",null,Object.keys(t.blogs).length))}))))))),r.a.createElement(I.c,null,r.a.createElement(I.a,{path:"/users/:id"},r.a.createElement(z,{props:Object(b.a)(Object(b.a)({},e),{},{visible:e.visible,setVisible:e.setVisible,history:e.history,setMessage:e.setMessage})}))))})),K=function(e){var t=e.props,n=Object(I.g)().id,a=Object(V.c)(),l={display:t.visible?"":"none"},c=t.blogs.find((function(e){return e.id===n}));return r.a.createElement("div",{style:l},r.a.createElement("br",null),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",{id:"b-left"},c.title),"by",r.a.createElement("b",{id:"b-right"},c.author)),r.a.createElement("br",null),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("a",{href:c.url},c.url)),r.a.createElement("li",{className:"list-group-item"},c.likes," likes",r.a.createElement("button",{type:"button",className:"btn btn-success",id:"like-button",onClick:function(){t.likeBlog(Object(b.a)(Object(b.a)({},c),{},{user:c.user.id})),t.setMessage("you liked '".concat(c.title,"'"),"msg",5)}},"like")),r.a.createElement("li",{className:"list-group-item"},"added by ",c.user.name,t.user.name===c.user.name&&r.a.createElement("button",{type:"button",id:"delete-button",className:"btn btn-warning",onClick:function(){t.history.goBack(),t.deleteBlog(n),t.setMessage("you deleted '".concat(c.title,"'"),"msg",5),a(y()),t.setVisible(!t.visible)}},"delete"),r.a.createElement("button",{type:"button",id:"back-button",className:"btn btn-primary",onClick:function(){t.history.goBack(),t.setVisible(!t.visible)},props:Object(b.a)({},t)},"back")))};function q(e,t){return t.likes-e.likes}var P={likeBlog:function(e){return function(){var t=Object(d.a)(f.a.mark((function t(n){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.update(e.id,Object(b.a)(Object(b.a)({},e),{},{likes:e.likes+1}));case 2:a=t.sent,n({type:"LIKE_BLOG",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},deleteBlog:function(e){return function(){var t=Object(d.a)(f.a.mark((function t(n){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.remove(e);case 2:a=t.sent,n({type:"DELETE_BLOG",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},setMessage:S},Q=Object(V.b)((function(e){return"ALL"===e.filter?{blogs:e.blogs.sort(q)}:{blogs:e.blogs.filter((function(t){return t.title.toLowerCase().includes(e.filter.content.toLowerCase())})).sort(q)}}),P)((function(e){console.log("Blogs",e);var t={display:e.visible?"none":""};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:t},r.a.createElement("br",null),r.a.createElement(W,null),r.a.createElement("h2",null,"Blogs"),r.a.createElement("div",null,null!==e.user?e.blogForm():null),r.a.createElement("div",null,r.a.createElement("ul",null,e.blogs.map((function(t){return r.a.createElement("li",{id:"boxed",className:"list-group-item",key:t.id},r.a.createElement(s.b,{to:"/blogs/".concat(t.id),onClick:function(){e.setVisible(!0),e.history.push("/blogs")}},t.title))}))))),r.a.createElement(I.c,null,r.a.createElement(I.a,{path:"/users"},r.a.createElement(H,{props:Object(b.a)(Object(b.a)({},e),{},{visible:e.visible,setVisible:e.setVisible,history:e.history,setMessage:e.setMessage})})),r.a.createElement(I.a,{path:"/blogs/:id"},r.a.createElement(K,{props:Object(b.a)(Object(b.a)({},e),{},{visible:e.visible,setVisible:e.setVisible,history:e.history,setMessage:e.setMessage})}))))})),X=function(){var e=Object(V.d)((function(e){var t=e.message;return null!==t?t:{which:"",text:""}}));return null===e?null:r.a.createElement("div",{style:"msg"===e.which?{color:"green",background:"lightgray",fontSize:20,borderStyle:"solid",borderRadius:5,padding:10,marginTop:10,marginBottom:10}:"err"===e.which?{color:"rgb(255, 0, 0)",background:"lightgray",fontSize:20,borderStyle:"solid",borderRadius:5,padding:10,marginTop:10,marginBottom:10}:null},e.text)},Y=function(){return r.a.createElement("div",{style:{color:"gray",fontStyle:"italic",fontSize:16}},r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement("center",null,r.a.createElement("em",null,"Bloglist app, Full Stack Web Development"),r.a.createElement("br",null),r.a.createElement("em",null,"University of Helsinki 2020")))},Z=r.a.forwardRef((function(e,t){var l=n(77).animateScroll,c=Object(a.useState)(!1),s=Object(A.a)(c,2),i=s[0],o=s[1],u={display:i?"none":""},m={display:i?"":"none"},b=function(){o(!i),i&&l.scrollToTop()};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:b}})),r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("div",{style:u},r.a.createElement("button",{className:"btn btn-primary",type:"submit",onClick:b},e.buttonLabel)),r.a.createElement("div",{style:m,className:"togglableContent"},e.children,r.a.createElement("button",{className:"btn btn-primary",type:"submit",style:{float:"right"},onClick:b},"cancel")))}));Z.displayName="Togglable";var $=Z,ee=function(){var e=Object(V.c)();Object(a.useEffect)((function(){e(y()),e(w())}),[e]);var t=Object(a.useState)(null),n=Object(A.a)(t,2),l=n[0],c=n[1],i=Object(a.useState)(!1),o=Object(A.a)(i,2),u=o[0],m=o[1],b=Object(a.useState)({which:"",text:""}),p=Object(A.a)(b,2),g=p[0],E=p[1],v=Object(I.f)(),O=Object(a.useRef)();Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBloglistappUser");if(e){var t=JSON.parse(e);c(t),h.setToken(t.token)}}),[]);var k=function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.username&&""!==t.password){e.next=4;break}E("both fields are required","err",5),e.next=16;break;case 4:return e.prev=4,e.next=7,U.login(t);case 7:n=e.sent,window.localStorage.setItem("loggedBloglistappUser",JSON.stringify(n)),h.setToken(n.token),c(n),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),E("wrong username or password","err",5);case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(d.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{c(null),window.localStorage.clear()}catch(n){E("".concat(n),"err",5)}window.location.reload(),E("logged out successfully","msg",5);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){return r.a.createElement(s.b,{to:"/create",onClick:function(){m(!0),v.push("/blogs")}},"CREATE NEW")};return r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{id:"nav",className:"navbar navbar-light bg-light"},r.a.createElement("a",{className:"navbar-brand",href:"/"},r.a.createElement("strong",null,"Bloglist")),null!==l?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(s.b,{to:"/blogs"},"blogs")),r.a.createElement("div",null,r.a.createElement(s.b,{to:"/users"},"users")),r.a.createElement("div",null,l.name," logged in",r.a.createElement("button",{className:"btn btn-primary ml-2",id:"logout-button",type:"submit",onClick:j},"Logout"))):r.a.createElement($,{buttonLabel:"sign in",ref:O},r.a.createElement(F,{loginUser:k}))),r.a.createElement("div",{className:"container"},r.a.createElement(X,{message:g}),r.a.createElement(I.c,null,r.a.createElement(I.a,{path:"/create"},r.a.createElement(D,{user:l,visible:!0,history:v,blogForm:x,setVisible:m})),r.a.createElement(I.a,{path:"/blogs"},null!==l?r.a.createElement(Q,{user:l,visible:u,history:v,blogForm:x,setVisible:m,setMessage:E}):null),r.a.createElement(I.a,{path:"/users"},null!==l?r.a.createElement(H,{user:l,visible:u,history:v,setVisible:m,setMessage:E}):null)),r.a.createElement(Y,null)))};n(85);c.a.render(r.a.createElement(V.a,{store:M},r.a.createElement(s.a,null,r.a.createElement(ee,null))),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.1f75413c.chunk.js.map